# Number Parser

Этот пакет делает одну очень простую вещь: преобразует строки, содержащие десятичные числа, в числа (int или float). Но делает это с проверкой корректности числа в исходной строке и бросанием исключения, если что-то не так.

## Зачем это может пригодиться?

Для преобразования строки в число в PHP есть множество методов. Для преобразования целого числа вы можете использовать:

```php
$i = (int) $str;
$i = intval($str);
```
Для дробного вы можете использовать:

```php
$f = (float) $str;
$f = floatval($str);
```
Но проблема этих методов в том, что они продолжают работать даже в том случае, если в строке было не совсем число, или даже совсем не число. Например:

```php
var_dump(intval('a')); // выведет int(0)

var_dump(intval(new stdClass())); // выведет int(1) (правда с PHP Warning "Object of class stdClass could not be converted to int")
```
В проектах чувствительных к ошибкам, где ошибки часто приводят к потере денег, вы можете захотеть использовать максимально строгую валидацию всех входных данных. В таком случае, вы можете попробовать использовать стандартные методы:

```php
$n = filter_var($str, FILTER_VALIDATE_INT);
$n = filter_var($str, FILTER_VALIDATE_FLOAT);
```

Теперь, если в `$str` будет что-то кроме числа (например, `"123a"`), то в `$n` сохранится `FALSE`. Однако, если вы строите логику обработки ошибок на исключениях, то вам нужно добавить такой код:

```php
if ($n === false) {
    throw new Exception("Invalid number in string");
}
```
А теперь представьте, что вам это нужно делать в множестве мест! Однако, хотя функция `filter_var()` хороша и имеет много различных опций, её валидаторы иногда недостаточно строгие. Например, `filter_var()` допускает числа с пробелами в начале или в конце (`" 123 ""`), допускает знак минус перед нулём (`"-0"`). Также вы не всегда можете хотеть видеть на входе числа в экспоненциальной форме (`"1.234e-4"`).

# Как это использовать?

Очень просто:

```
composer require gugglegum/number-parser
```

```php
use \gugglegum\NumberParser\NumberParser;

try {
    ...

    $i = NumberParser::parseInt($str1);
    $f = NumberParser::parseFloat($str2);
    $e = NumberParser::parseFloatExponent($str3);

    ...
} catch (Exception $e) {
    echo "Error: {$e->getMessage()}\n";
}
```

Данные методы имеет смысл применять ко всем числовым данным, получаемых извне: `$_SERVER['argv']`, `$_GET`, `$_POST`, `$_COOKIE`, `$_ENV`, `fgets()` и т.д.

### Примеры корректных чисел

Целые:
```
"1"
"-12345"
"1234567890"
```
Дробные:
```
"0.1"
"0.10"
".1"
"1.23"
```
Дробные с экспонентой:
```
"1e2"
"1e+2""
"1e-2"
"1.23e2"
"12.3e1"
"0.1e2"
".123e-2"
```

### Примеры некорректных чисел

Целые:
```
"a567"
"567a"
" 567"
"567 "
"56_7"
"-0"
"00"
"-00"
"01"
"+1"
".1"
"1e2"
""
```
Дробные:
```
"a56.7"
"56.7a"
" 56.7"
"56.7 "
"5_6.7"
"00"
"00.0"
"0"
"-0.0"
"-.0"
"+1.2"
"."
""
```
Дробные с экспонентой:
```
"e",
"1e",
"1e+",
"1e-",
"e+2",
"e-2",
".e2",
```

## Как запустить тесты?

```
composer intall
vendor/bin/phpunit
```
